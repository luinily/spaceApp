//
//  ApodInteractor.swift
//  spaceApp
//
//  Created by Coldefy Yoann on 2016/07/17.
//  Copyright (c) 2016å¹´ YoannColdefy. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so you can apply
//  clean architecture to your iOS and Mac projects, see http://clean-swift.com
//

import UIKit

protocol ApodInteractorInput {
	func fetchTodayApod(request: TodayApodRequest)
	func fetchRandomApod(request: RandomApodRequest)
}

protocol ApodInteractorOutput {
	func presentApod(response: ApodResponse)
	func presentError(response: ApodErrorResponse)
}

class ApodInteractor: ApodInteractorInput {
	var output: ApodInteractorOutput!
	private var _apodWorker: ApodWorker
	
	init(apodWorker: ApodWorker) {
		_apodWorker = apodWorker
	}
	
	// MARK: Business logic
	func fetchTodayApod(request: TodayApodRequest) {
		_apodWorker.fetchTodayAPOD() {
			apodData, error in
			self.handleFetchResults(apodData: apodData, error: error)
		}
	}

	func fetchRandomApod(request: RandomApodRequest) {
		_apodWorker.fetchRandomApod() {
			apodData, error in
			self.handleFetchResults(apodData: apodData, error: error)
		}
	}
	
	private func handleFetchResults(apodData: ApodData?, error: NSError?) {
		if let apodData = apodData {
			let response = ApodResponse(apodData: apodData)
			self.output.presentApod(response: response)
		}
		
		if let error = error {
			let response = ApodErrorResponse(error: error)
			self.output.presentError(response: response)
		}
	}
}
